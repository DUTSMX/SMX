<!DOCTYPE html>
<html>
<head>
    <title>尚名校</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="cache-control" content="no-cache"/>
    <link rel="stylesheet" type="text/css" href="/stylesheets/jquery.mobile-1.4.5.min.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/smxtheme.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/personDetail.css">
</head>
<body onload="uploadImg()">
<div data-role="page" data-title="尚名校">
    <div data-role="header" data-theme="g" data-position="fixed">
        <img src="/images/ic_arrow_back.png" onclick="goBack()" class="left_icon"/>
        <span class="edit"><a href="personDetailEdit"data-ajax="false"><img src="/images/编辑.png"></a></span>
        <h3 class="page_title">个人信息</h3>
        <!--<img src="/images/ic_share.png" href="#" class="right_icon"/>-->
    </div>
    <div class="teacherInfo">
        <ul data-role="listview">
            <li data-icon="false">

                <hr width="1" size="20" color="#3B7454" class="hr">
                <h5 class="type">头像</h5>
                <h5 class="specialDetail"><img id="head"src="/images/头像.png"style="width:50px;height:50px"></h5>
                <div style="position: absolute;width:100%;height:100%;left:0px;top:0px;opacity:0">
                    <input type="file" id="file" accept="image/" style="height:200px;"/>
                </div>
            </li>
            <li data-icon="false">
                <hr width="1" size="20" color="#3B7454" class="hr">
                <h5 class="type">姓名</h5>
                <h5 class="detail"><%=userName%></h5>
            </li>
            <li data-icon="false">
                <hr width="1" size="20" color="#3B7454" class="hr">
                <h5 class="type">性别</h5>
                <h5 class="detail"><%if(gender==1){%>男<%} else if(gender == 2){%>女<%}%></h5>
            </li>
            <li data-icon="false">

                    <hr width="1" size="20" color="#3B7454" class="hr">
                    <h5 class="type">年龄</h5>
                    <h5 id="age" class="detail"><%=userAge%></h5>

            </li>
            <li data-icon="false">
                <hr width="1" size="20" color="#3B7454" class="hr">
                <h5 class="type">所在学校</h5>
                <h5 class="detail"><%=userSchool%></h5>
            </li>
            <li data-icon="false">
                <hr width="1" size="20" color="#3B7454" class="hr">
                <h5 class="type">年级</h5>
                <h5 class="detail"><%=userGrade%></h5>
            </li>
            <li data-icon="false">
                <hr width="1" size="20" color="#3B7454" class="hr">
                <h5 class="type">家庭住址</h5>
                <h5 class="detail"><%=userAddress%></h5>
            </li>
        </ul>
        <p id="hint"></p>
    </div>
    <script src="/javascripts/sdk/jquery1x.min.js"></script>
    <script src="/javascripts/jquery.mobile-1.4.5.min.js"></script>
    <script src="/javascripts/slick.min.js"></script>
    <script src="/javascripts/smx.js"></script>
    <script src="/javascripts/sdk/qcloud_sdk.js"></script>
    <script src="/javascripts/sdk/swfobject.js"></script>
    <script src="/javascripts/sha1.js"></script>
    <script type="text/javascript">
        define = null;
        require = null;
    </script>
    <script src="http://res.wx.qq.com/open.js/jweixin-1.0.0.js" type="text/javascript"></script>
    <script>
//        console.log("script")
//        $.get("/getJSTicket",function (result) {
//            console.log(result);
//            var jsapi_ticket = result;
//            var noncestr = "yaohan";
//            var timestamp = (new Date()).valueOf();
//            var url = "http://www.shangmingxiao.com/users/personDetail"
//            var string = "jsapi_ticket="+jsapi_ticket+"&noncestr="+noncestr+"&timestamp="+timestamp+"&url="+url;
//            var signature = hex_sha1(string);
//            wx.config({
//                debug:true,
//                appId:wxdc031022f3870a62,
//                timestamp:timestamp,
//                nonceStr:noncestr,
//                signature:signature
//            })
//        })

        function uploadImg() {
            var cos = new CosCloud("10068625","/")
            var successCallBack = function (result) {
                $("#age").val("success:"+JSON.stringify(result));
                console.log("success")
                console.log("result:"+JSON.stringify(result))
                console.log("type"+typeof result)
                console.log("修改图片"+JSON.parse(result).data.access_url)
                $("#head").attr('src',JSON.parse(result).data.access_url)
            }
            var errorCallBack = function (result) {
                $("#age").val("error:"+result);
                console.log("error")
                console.log("result:"+JSON.stringify(result))
            }
            var inputElements = document.getElementById("file");
            inputElements.addEventListener("change",handleFiles,false);
            function handleFiles(){
                var fileList = this.files;
                if(fileList.length>0){
                    selectedFile = fileList[0];
                    cos.uploadFile(successCallBack,errorCallBack,"smxbucket","/"+selectedFile.name,selectedFile,0)
                }
            }
//            $('input[type="file"]').change(function (e) {
//                console.log(e.files)
//            })
//            var myFile = document.getElementById("#file");
//            console.log("file:"+JSON.stringify($("#file")));
//            console.log("selectedFile:"+JSON.stringify($('#input')))
//            var selectedFile = $('#file').get(0).files[0];
//
        }
    </script>
</div>
</body>
</html>
